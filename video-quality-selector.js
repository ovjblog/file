(function(_V_){var methods={extend:function(destination,source){for(var prop in source){if(!source.hasOwnProperty(prop)){continue;}
if(typeof source[prop]=='object'&&null!==source[prop]){destination[prop]=methods.extend(destination[prop]||{},source[prop]);}else{destination[prop]=source[prop];}}
return destination;},res_label:function(res){return(/^\d+$/.test(res))?res+'p':res;}};_V_.ResolutionMenuItem=_V_.MenuItem.extend({init:function(player,options){options.label=methods.res_label(options.res);options.selected=(options.res.toString()===player.getCurrentRes().toString());_V_.MenuItem.call(this,player,options);this.resolution=options.res;this.on('click',this.onClick);player.on('changeRes',_V_.bind(this,function(){if(this.resolution==player.getCurrentRes()){this.selected(true);}else{this.selected(false);}}));}});_V_.ResolutionMenuItem.prototype.onClick=function(){var player=this.player(),video_el=player.el().firstChild,current_time=player.currentTime(),is_paused=player.paused(),button_nodes=player.controlBar.resolutionSelector.el().firstChild.children,button_node_count=button_nodes.length;if(player.getCurrentRes()==this.resolution){return;}
if('none'==video_el.preload){video_el.preload='metadata';}
player.src(player.availableRes[this.resolution]).one('loadedmetadata',function(){player.currentTime(current_time);if(!is_paused){player.play();}});player.currentRes=this.resolution;while(button_node_count>0){button_node_count--;if('vjs-current-res'==button_nodes[button_node_count].className){button_nodes[button_node_count].innerHTML=methods.res_label(this.resolution);break;}}
player.trigger('changeRes');};_V_.ResolutionTitleMenuItem=_V_.MenuItem.extend({init:function(player,options){_V_.MenuItem.call(this,player,options);this.off('click');}});_V_.ResolutionSelector=_V_.MenuButton.extend({init:function(player,options){player.availableRes=options.available_res;_V_.MenuButton.call(this,player,options);}});_V_.ResolutionSelector.prototype.createItems=function(){var player=this.player(),items=[],current_res;items.push(new _V_.ResolutionTitleMenuItem(player,{el:_V_.Component.prototype.createEl('li',{className:'vjs-menu-title vjs-res-menu-title',innerHTML:'Resolusi'})}));for(current_res in player.availableRes){if('length'==current_res){continue;}
items.push(new _V_.ResolutionMenuItem(player,{res:current_res}));}
items.sort(function(a,b){if(typeof a.resolution=='undefined'){return-1;}else{return parseInt(b.resolution)- parseInt(a.resolution);}});return items;};_V_.plugin('resolutionSelector',function(options){if(!this.el().firstChild.canPlayType){return;}
var player=this,sources=player.options().sources,i=sources.length,j,found_type,settings=methods.extend({default_res:'',force_types:false},options||{}),available_res={length:0},current_res,resolutionSelector,default_resolutions=(settings.default_res&&typeof settings.default_res=='string')?settings.default_res.split(','):[];while(i>0){i--;if(!sources[i]['data-res']){continue;}
current_res=sources[i]['data-res'];if(typeof available_res[current_res]!=='object'){available_res[current_res]=[];available_res.length++;}
available_res[current_res].push(sources[i]);}
if(settings.force_types){for(current_res in available_res){if('length'==current_res){continue;}
i=settings.force_types.length;while(i>0){i--;j=available_res[current_res].length;found_types=0;while(j>0){j--;if(settings.force_types[i]===available_res[current_res][j].type){found_types++;}}
if(found_types<settings.force_types.length){delete available_res[current_res];available_res.length--;break;}}}}
if(available_res.length<2){return;}
for(i=0;i<default_resolutions.length;i++){if(available_res[default_resolutions[i]]){player.src(available_res[default_resolutions[i]]);player.currentRes=default_resolutions[i];break;}}
player.getCurrentRes=function(){if(typeof player.currentRes!=='undefined'){return player.currentRes;}else{try{return res=player.options().sources[0]['data-res'];}catch(e){return'';}}};current_res=player.getCurrentRes();if(current_res){current_res=methods.res_label(current_res);}
resolutionSelector=new _V_.ResolutionSelector(player,{el:_V_.Component.prototype.createEl(null,{className:'vjs-res-button vjs-menu-button vjs-control',innerHTML:'<div class="vjs-control-content"><span class="vjs-current-res">'+(current_res||'Resolusi')+'</span></div>',role:'button','aria-live':'polite',tabIndex:0}),available_res:available_res});player.controlBar.resolutionSelector=player.controlBar.addChild(resolutionSelector);});})(videojs);
